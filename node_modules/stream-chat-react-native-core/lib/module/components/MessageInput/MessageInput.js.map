{"version":3,"sources":["MessageInput.tsx"],"names":["styles","StyleSheet","create","attachmentSeparator","borderBottomWidth","marginBottom","autoCompleteInputContainer","alignItems","flexDirection","paddingLeft","paddingRight","composerContainer","container","borderTopWidth","padding","inputBoxContainer","borderRadius","borderWidth","flex","optionsContainer","paddingBottom","replyContainer","paddingHorizontal","sendButtonContainer","suggestionsListContainer","elevation","left","position","right","shadowOffset","height","width","shadowOpacity","MessageInputWithContext","props","additionalTextInputProps","asyncIds","asyncUploads","AutoCompleteSuggestionList","closeAttachmentPicker","cooldownEndsAt","CooldownTimer","disabled","editing","FileUploadPreview","fileUploads","giphyActive","ImageUploadPreview","imageUploads","Input","inputBoxRef","InputButtons","InputEditingStateHeader","InputGiphySearch","InputReplyStateHeader","isValidMessage","maxNumberOfFiles","members","mentionedUsers","numberOfUploads","quotedMessage","removeFile","removeImage","Reply","resetInput","SendButton","sending","sendMessageAsync","ShowThreadMessageInChannelButton","suggestions","thread","threadList","triggerType","uploadNewFile","uploadNewImage","watchers","setHeight","theme","colors","border","grey_whisper","white","white_smoke","messageInput","attachmentSelectionBar","suggestionListContainer","attachmentPickerBottomSheetHeight","attachmentSelectionBarHeight","bottomInset","selectedFiles","selectedImages","selectedPicker","setMaxNumberOfFiles","setSelectedFiles","setSelectedImages","cooldownRemainingSeconds","seconds","hasResetImages","setHasResetImages","hasResetFiles","setHasResetFiles","selectedImagesLength","length","imageUploadsLength","selectedFilesLength","fileUploadsLength","imagesForInput","forEach","image","id","file","uploadImagesHandler","imagesToUpload","filter","selectedImage","uploadedImage","find","imageUpload","uri","url","removeImagesHandler","imagesToRemove","filesToUpload","selectedFile","uploadedFile","fileUpload","filesToRemove","updatedSelectedImages","map","source","Boolean","updatedSelectedFiles","duration","name","size","type","editingExists","current","focus","asyncIdsString","join","asyncUploadsString","Object","values","state","keys","getMembers","result","member","user","push","getUsers","users","getWatchers","uniqueUsers","usersArray","additionalTextInputContainerProps","editable","undefined","newHeight","nativeEvent","layout","backgroundColor","borderColor","paddingVertical","quoted_message","borderBottomColor","marginHorizontal","bottom","data","onSelect","queryText","areEqual","prevProps","nextProps","prevAdditionalTextInputProps","prevAsyncUploads","prevDisabled","prevEditing","prevFileUploads","prevGiphyActive","prevImageUploads","prevIsValidMessage","prevMentionedUsers","prevQuotedMessage","prevSending","prevShowMoreOptions","showMoreOptions","prevSuggestions","prevT","t","prevThread","prevThreadList","nextAdditionalTextInputProps","nextAsyncUploads","nextDisabled","nextEditing","nextFileUploads","nextGiphyActive","nextImageUploads","nextIsValidMessage","nextMentionedUsers","nextQuotedMessage","nextSending","nextShowMoreOptions","nextSuggestions","nextT","nextThread","nextThreadList","tEqual","additionalTextInputPropsEven","disabledEqual","editingEqual","imageUploadsEqual","giphyActiveEqual","quotedMessageEqual","sendingEqual","showMoreOptionsEqual","isValidMessageEqual","asyncUploadsEqual","every","key","fileUploadsEqual","mentionedUsersEqual","suggestionsEqual","index","threadEqual","text","reply_count","threadListEqual","MemoizedMessageInput","React","memo","MessageInput","ownCapabilities","clearEditingState","clearQuotedMessageState","SendMessageDisallowedIndicator","setGiphyActive","setShowMoreOptions","AutoCompleteSuggestionHeader","AutoCompleteSuggestionItem","sendMessage","displayName"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { StyleSheet, View } from 'react-native';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport { useCountdown } from './hooks/useCountdown';\n\nimport { useAttachmentPickerContext } from '../../contexts/attachmentPickerContext/AttachmentPickerContext';\nimport {\n  ChannelContextValue,\n  useChannelContext,\n} from '../../contexts/channelContext/ChannelContext';\nimport {\n  MessageInputContextValue,\n  useMessageInputContext,\n} from '../../contexts/messageInputContext/MessageInputContext';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { useOwnCapabilitiesContext } from '../../contexts/ownCapabilitiesContext/OwnCapabilitiesContext';\nimport {\n  SuggestionsContextValue,\n  useSuggestionsContext,\n} from '../../contexts/suggestionsContext/SuggestionsContext';\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport { ThreadContextValue, useThreadContext } from '../../contexts/threadContext/ThreadContext';\nimport {\n  TranslationContextValue,\n  useTranslationContext,\n} from '../../contexts/translationContext/TranslationContext';\n\nimport type { Asset, DefaultStreamChatGenerics } from '../../types/types';\nimport { AttachmentSelectionBar } from '../AttachmentPicker/components/AttachmentSelectionBar';\nimport { AutoCompleteInput } from '../AutoCompleteInput/AutoCompleteInput';\n\nconst styles = StyleSheet.create({\n  attachmentSeparator: {\n    borderBottomWidth: 1,\n    marginBottom: 10,\n  },\n  autoCompleteInputContainer: {\n    alignItems: 'center',\n    flexDirection: 'row',\n    paddingLeft: 16,\n    paddingRight: 16,\n  },\n  composerContainer: {\n    alignItems: 'flex-end',\n    flexDirection: 'row',\n  },\n  container: {\n    borderTopWidth: 1,\n    padding: 10,\n  },\n  inputBoxContainer: {\n    borderRadius: 20,\n    borderWidth: 1,\n    flex: 1,\n  },\n  optionsContainer: {\n    flexDirection: 'row',\n    paddingBottom: 10,\n    paddingRight: 10,\n  },\n  replyContainer: { paddingBottom: 12, paddingHorizontal: 8 },\n  sendButtonContainer: { paddingBottom: 10, paddingLeft: 10 },\n  suggestionsListContainer: {\n    borderRadius: 10,\n    elevation: 3,\n    left: 8,\n    position: 'absolute',\n    right: 8,\n    shadowOffset: { height: 1, width: 0 },\n    shadowOpacity: 0.15,\n  },\n});\n\ntype MessageInputPropsWithContext<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Pick<ChannelContextValue<StreamChatGenerics>, 'disabled' | 'members' | 'watchers'> &\n  Pick<\n    MessageInputContextValue<StreamChatGenerics>,\n    | 'additionalTextInputProps'\n    | 'asyncIds'\n    | 'asyncUploads'\n    | 'cooldownEndsAt'\n    | 'CooldownTimer'\n    | 'clearEditingState'\n    | 'clearQuotedMessageState'\n    | 'closeAttachmentPicker'\n    | 'editing'\n    | 'FileUploadPreview'\n    | 'fileUploads'\n    | 'giphyActive'\n    | 'ImageUploadPreview'\n    | 'imageUploads'\n    | 'Input'\n    | 'inputBoxRef'\n    | 'InputButtons'\n    | 'InputEditingStateHeader'\n    | 'InputGiphySearch'\n    | 'InputReplyStateHeader'\n    | 'isValidMessage'\n    | 'maxNumberOfFiles'\n    | 'mentionedUsers'\n    | 'numberOfUploads'\n    | 'quotedMessage'\n    | 'resetInput'\n    | 'SendButton'\n    | 'sending'\n    | 'sendMessageAsync'\n    | 'setShowMoreOptions'\n    | 'setGiphyActive'\n    | 'showMoreOptions'\n    | 'ShowThreadMessageInChannelButton'\n    | 'removeFile'\n    | 'removeImage'\n    | 'uploadNewFile'\n    | 'uploadNewImage'\n  > &\n  Pick<MessagesContextValue<StreamChatGenerics>, 'Reply'> &\n  Pick<\n    SuggestionsContextValue<StreamChatGenerics>,\n    | 'AutoCompleteSuggestionHeader'\n    | 'AutoCompleteSuggestionItem'\n    | 'AutoCompleteSuggestionList'\n    | 'suggestions'\n    | 'triggerType'\n  > &\n  Pick<ThreadContextValue<StreamChatGenerics>, 'thread'> &\n  Pick<TranslationContextValue, 't'> & {\n    threadList?: boolean;\n  };\n\nconst MessageInputWithContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: MessageInputPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    additionalTextInputProps,\n    asyncIds,\n    asyncUploads,\n    AutoCompleteSuggestionList,\n    closeAttachmentPicker,\n    cooldownEndsAt,\n    CooldownTimer,\n    disabled,\n    editing,\n    FileUploadPreview,\n    fileUploads,\n    giphyActive,\n    ImageUploadPreview,\n    imageUploads,\n    Input,\n    inputBoxRef,\n    InputButtons,\n    InputEditingStateHeader,\n    InputGiphySearch,\n    InputReplyStateHeader,\n    isValidMessage,\n    maxNumberOfFiles,\n    members,\n    mentionedUsers,\n    numberOfUploads,\n    quotedMessage,\n    removeFile,\n    removeImage,\n    Reply,\n    resetInput,\n    SendButton,\n    sending,\n    sendMessageAsync,\n    ShowThreadMessageInChannelButton,\n    suggestions,\n    thread,\n    threadList,\n    triggerType,\n    uploadNewFile,\n    uploadNewImage,\n    watchers,\n  } = props;\n\n  const [height, setHeight] = useState(0);\n\n  const {\n    theme: {\n      colors: { border, grey_whisper, white, white_smoke },\n      messageInput: {\n        attachmentSelectionBar,\n        autoCompleteInputContainer,\n        composerContainer,\n        container,\n        inputBoxContainer,\n        optionsContainer,\n        replyContainer,\n        sendButtonContainer,\n        suggestionsListContainer: { container: suggestionListContainer },\n      },\n    },\n  } = useTheme();\n\n  const {\n    attachmentPickerBottomSheetHeight,\n    attachmentSelectionBarHeight,\n    bottomInset,\n    selectedFiles,\n    selectedImages,\n    selectedPicker,\n    setMaxNumberOfFiles,\n    setSelectedFiles,\n    setSelectedImages,\n  } = useAttachmentPickerContext();\n\n  const { seconds: cooldownRemainingSeconds } = useCountdown(cooldownEndsAt);\n\n  /**\n   * Mounting and un-mounting logic are un-related in following useEffect.\n   * While mounting we want to pass maxNumberOfFiles (which is prop on Channel component)\n   * to AttachmentPicker (on OverlayProvider)\n   *\n   * While un-mounting, we want to close the picker e.g., while navigating away.\n   */\n  useEffect(() => {\n    setMaxNumberOfFiles(maxNumberOfFiles ?? 10);\n\n    return closeAttachmentPicker;\n  }, []);\n\n  const [hasResetImages, setHasResetImages] = useState(false);\n  const [hasResetFiles, setHasResetFiles] = useState(false);\n  const selectedImagesLength = hasResetImages ? selectedImages.length : 0;\n  const imageUploadsLength = hasResetImages ? imageUploads.length : 0;\n  const selectedFilesLength = hasResetFiles ? selectedFiles.length : 0;\n  const fileUploadsLength = hasResetFiles ? fileUploads.length : 0;\n  const imagesForInput = (!!thread && !!threadList) || (!thread && !threadList);\n\n  useEffect(() => {\n    setSelectedImages([]);\n    if (imageUploads.length) {\n      imageUploads.forEach((image) => removeImage(image.id));\n    }\n    return () => setSelectedImages([]);\n  }, []);\n\n  useEffect(() => {\n    setSelectedFiles([]);\n    if (fileUploads.length) {\n      fileUploads.forEach((file) => removeFile(file.id));\n    }\n    return () => setSelectedFiles([]);\n  }, []);\n\n  useEffect(() => {\n    if (hasResetImages === false && imageUploadsLength === 0 && selectedImagesLength === 0) {\n      setHasResetImages(true);\n    }\n  }, [imageUploadsLength, selectedImagesLength]);\n\n  useEffect(() => {\n    if (hasResetFiles === false && fileUploadsLength === 0 && selectedFilesLength === 0) {\n      setHasResetFiles(true);\n    }\n  }, [fileUploadsLength, selectedFilesLength]);\n\n  useEffect(() => {\n    if (imagesForInput === false && imageUploads.length) {\n      imageUploads.forEach((image) => removeImage(image.id));\n    }\n  }, [imagesForInput]);\n\n  const uploadImagesHandler = () => {\n    const imagesToUpload = selectedImages.filter((selectedImage) => {\n      const uploadedImage = imageUploads.find(\n        (imageUpload) =>\n          imageUpload.file.uri === selectedImage.uri || imageUpload.url === selectedImage.uri,\n      );\n      return !uploadedImage;\n    });\n    imagesToUpload.forEach((image) => uploadNewImage(image));\n  };\n\n  const removeImagesHandler = () => {\n    const imagesToRemove = imageUploads.filter(\n      (imageUpload) =>\n        !selectedImages.find(\n          (selectedImage) =>\n            selectedImage.uri === imageUpload.file.uri || selectedImage.uri === imageUpload.url,\n        ),\n    );\n    imagesToRemove.forEach((image) => removeImage(image.id));\n  };\n\n  useEffect(() => {\n    if (imagesForInput) {\n      if (selectedImagesLength > imageUploadsLength) {\n        /** User selected an image in bottom sheet attachment picker */\n        uploadImagesHandler();\n      } else {\n        /** User de-selected an image in bottom sheet attachment picker */\n        removeImagesHandler();\n      }\n    }\n  }, [selectedImagesLength]);\n\n  useEffect(() => {\n    if (selectedFilesLength > fileUploadsLength) {\n      /** User selected a video in bottom sheet attachment picker */\n      const filesToUpload = selectedFiles.filter((selectedFile) => {\n        const uploadedFile = fileUploads.find(\n          (fileUpload) =>\n            fileUpload.file.uri === selectedFile.uri || fileUpload.url === selectedFile.uri,\n        );\n        return !uploadedFile;\n      });\n      filesToUpload.forEach((file) => uploadNewFile(file));\n    } else {\n      /** User de-selected a video in bottom sheet attachment picker */\n      const filesToRemove = fileUploads.filter(\n        (fileUpload) =>\n          !selectedFiles.find(\n            (selectedFile) =>\n              selectedFile.uri === fileUpload.file.uri || selectedFile.uri === fileUpload.url,\n          ),\n      );\n      filesToRemove.forEach((file) => removeFile(file.id));\n    }\n  }, [selectedFilesLength]);\n\n  useEffect(() => {\n    if (imagesForInput) {\n      if (imageUploadsLength < selectedImagesLength) {\n        /** User removed some image from seleted images within ImageUploadPreview. */\n        const updatedSelectedImages = selectedImages.filter((selectedImage) => {\n          const uploadedImage = imageUploads.find(\n            (imageUpload) =>\n              imageUpload.file.uri === selectedImage.uri || imageUpload.url === selectedImage.uri,\n          );\n          return uploadedImage;\n        });\n        setSelectedImages(updatedSelectedImages);\n      } else if (imageUploadsLength > selectedImagesLength) {\n        /**\n         * User is editing some message which contains image attachments OR\n         * image attachment is added from custom image picker (other than the default bottomsheet image picker)\n         * using `uploadNewImage` function from `MessageInputContext`.\n         **/\n        setSelectedImages(\n          imageUploads\n            .map((imageUpload) => ({\n              height: imageUpload.file.height,\n              source: imageUpload.file.source,\n              uri: imageUpload.url || imageUpload.file.uri,\n              width: imageUpload.file.width,\n            }))\n            .filter(Boolean) as Asset[],\n        );\n      }\n    }\n  }, [imageUploadsLength]);\n\n  useEffect(() => {\n    if (fileUploadsLength < selectedFilesLength) {\n      /** User removed some video from seleted files within ImageUploadPreview. */\n      const updatedSelectedFiles = selectedFiles.filter((selectedFile) => {\n        const uploadedFile = fileUploads.find(\n          (fileUpload) =>\n            fileUpload.file.uri === selectedFile.uri || fileUpload.url === selectedFile.uri,\n        );\n        return uploadedFile;\n      });\n      setSelectedFiles(updatedSelectedFiles);\n    } else if (fileUploadsLength > selectedFilesLength) {\n      /**\n       * User is editing some message which contains video attachments OR\n       * video attachment is added from custom image picker (other than the default bottomsheet image picker)\n       * using `uploadNewFile` function from `MessageInputContext`.\n       **/\n      setSelectedFiles(\n        fileUploads.map((fileUpload) => ({\n          duration: fileUpload.file.duration,\n          name: fileUpload.file.name,\n          size: fileUpload.file.size,\n          type: fileUpload.file.type,\n          uri: fileUpload.file.uri,\n        })),\n      );\n    }\n  }, [fileUploadsLength]);\n\n  const editingExists = !!editing;\n  useEffect(() => {\n    if (editing && inputBoxRef.current) {\n      inputBoxRef.current.focus();\n    }\n\n    /**\n     * Make sure to test `initialValue` functionality, if you are modifying following condition.\n     *\n     * We have the following condition, to make sure - when user comes out of \"editing message\" state,\n     * we wipe out all the state around message input such as text, mentioned users, image uploads etc.\n     * But it also means, this condition will be fired up on first render, which may result in clearing\n     * the initial value set on input box, through the prop - `initialValue`.\n     * This prop generally gets used for the case of draft message functionality.\n     */\n    if (\n      !editing &&\n      (giphyActive ||\n        fileUploads.length > 0 ||\n        mentionedUsers.length > 0 ||\n        imageUploads.length > 0 ||\n        numberOfUploads > 0)\n    ) {\n      resetInput();\n    }\n  }, [editingExists]);\n\n  const asyncIdsString = asyncIds.join();\n  const asyncUploadsString = Object.values(asyncUploads)\n    .map(({ state, url }) => `${state}${url}`)\n    .join();\n  useEffect(() => {\n    if (Object.keys(asyncUploads).length) {\n      /**\n       * When successful image upload response occurs after hitting send,\n       * send a follow up message with the image\n       */\n      sending.current = true;\n      asyncIds.forEach((id) => sendMessageAsync(id));\n      sending.current = false;\n    }\n  }, [asyncIdsString, asyncUploadsString, sendMessageAsync]);\n\n  const getMembers = () => {\n    const result: UserResponse<StreamChatGenerics>[] = [];\n    if (members && Object.values(members).length) {\n      Object.values(members).forEach((member) => {\n        if (member.user) {\n          result.push(member.user);\n        }\n      });\n    }\n\n    return result;\n  };\n\n  const getUsers = () => {\n    const users = [...getMembers(), ...getWatchers()];\n\n    // make sure we don't list users twice\n    const uniqueUsers: { [key: string]: UserResponse<StreamChatGenerics> } = {};\n    for (const user of users) {\n      if (user && !uniqueUsers[user.id]) {\n        uniqueUsers[user.id] = user;\n      }\n    }\n    const usersArray = Object.values(uniqueUsers);\n\n    return usersArray;\n  };\n\n  const getWatchers = () => {\n    const result: UserResponse<StreamChatGenerics>[] = [];\n    if (watchers && Object.values(watchers).length) {\n      result.push(...Object.values(watchers));\n    }\n\n    return result;\n  };\n\n  const additionalTextInputContainerProps = {\n    editable: disabled ? false : undefined,\n    ...additionalTextInputProps,\n  };\n\n  return (\n    <>\n      <View\n        onLayout={({\n          nativeEvent: {\n            layout: { height: newHeight },\n          },\n        }) => setHeight(newHeight)}\n        style={[styles.container, { backgroundColor: white, borderColor: border }, container]}\n      >\n        {editing && <InputEditingStateHeader />}\n        {quotedMessage && <InputReplyStateHeader />}\n        <View style={[styles.composerContainer, composerContainer]}>\n          {Input ? (\n            <Input\n              additionalTextInputProps={additionalTextInputContainerProps}\n              getUsers={getUsers}\n            />\n          ) : (\n            <>\n              <View style={[styles.optionsContainer, optionsContainer]}>\n                {InputButtons && <InputButtons />}\n              </View>\n              <View\n                style={[\n                  styles.inputBoxContainer,\n                  {\n                    borderColor: grey_whisper,\n                    paddingVertical: giphyActive ? 8 : 12,\n                  },\n                  inputBoxContainer,\n                ]}\n              >\n                {((typeof editing !== 'boolean' && editing?.quoted_message) || quotedMessage) && (\n                  <View style={[styles.replyContainer, replyContainer]}>\n                    <Reply />\n                  </View>\n                )}\n                {imageUploads.length ? <ImageUploadPreview /> : null}\n                {imageUploads.length && fileUploads.length ? (\n                  <View\n                    style={[\n                      styles.attachmentSeparator,\n                      {\n                        borderBottomColor: grey_whisper,\n                        marginHorizontal: giphyActive ? 8 : 12,\n                      },\n                    ]}\n                  />\n                ) : null}\n                {fileUploads.length ? <FileUploadPreview /> : null}\n                {giphyActive ? (\n                  <InputGiphySearch />\n                ) : (\n                  <View style={[styles.autoCompleteInputContainer, autoCompleteInputContainer]}>\n                    <AutoCompleteInput<StreamChatGenerics>\n                      additionalTextInputProps={additionalTextInputProps}\n                      cooldownActive={!!cooldownRemainingSeconds}\n                    />\n                  </View>\n                )}\n              </View>\n              <View style={[styles.sendButtonContainer, sendButtonContainer]}>\n                {cooldownRemainingSeconds ? (\n                  <CooldownTimer seconds={cooldownRemainingSeconds} />\n                ) : (\n                  <SendButton disabled={disabled || sending.current || !isValidMessage()} />\n                )}\n              </View>\n            </>\n          )}\n        </View>\n        <ShowThreadMessageInChannelButton threadList={threadList} />\n      </View>\n\n      {triggerType && suggestions ? (\n        <View\n          style={[\n            suggestionListContainer,\n            styles.suggestionsListContainer,\n            { backgroundColor: white, bottom: height },\n          ]}\n        >\n          <AutoCompleteSuggestionList\n            active={!!suggestions}\n            data={suggestions.data}\n            onSelect={suggestions.onSelect}\n            queryText={suggestions.queryText}\n            triggerType={triggerType}\n          />\n        </View>\n      ) : null}\n      {selectedPicker && (\n        <View\n          style={[\n            {\n              backgroundColor: white_smoke,\n              height:\n                (attachmentPickerBottomSheetHeight\n                  ? attachmentPickerBottomSheetHeight + (attachmentSelectionBarHeight ?? 52)\n                  : 360) - bottomInset,\n            },\n            attachmentSelectionBar,\n          ]}\n        >\n          <AttachmentSelectionBar />\n        </View>\n      )}\n    </>\n  );\n};\n\nconst areEqual = <StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics>(\n  prevProps: MessageInputPropsWithContext<StreamChatGenerics>,\n  nextProps: MessageInputPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    additionalTextInputProps: prevAdditionalTextInputProps,\n    asyncUploads: prevAsyncUploads,\n    disabled: prevDisabled,\n    editing: prevEditing,\n    fileUploads: prevFileUploads,\n    giphyActive: prevGiphyActive,\n    imageUploads: prevImageUploads,\n    isValidMessage: prevIsValidMessage,\n    mentionedUsers: prevMentionedUsers,\n    quotedMessage: prevQuotedMessage,\n    sending: prevSending,\n    showMoreOptions: prevShowMoreOptions,\n    suggestions: prevSuggestions,\n    t: prevT,\n    thread: prevThread,\n    threadList: prevThreadList,\n  } = prevProps;\n  const {\n    additionalTextInputProps: nextAdditionalTextInputProps,\n    asyncUploads: nextAsyncUploads,\n    disabled: nextDisabled,\n    editing: nextEditing,\n    fileUploads: nextFileUploads,\n    giphyActive: nextGiphyActive,\n    imageUploads: nextImageUploads,\n    isValidMessage: nextIsValidMessage,\n    mentionedUsers: nextMentionedUsers,\n    quotedMessage: nextQuotedMessage,\n    sending: nextSending,\n    showMoreOptions: nextShowMoreOptions,\n    suggestions: nextSuggestions,\n    t: nextT,\n    thread: nextThread,\n    threadList: nextThreadList,\n  } = nextProps;\n\n  const tEqual = prevT === nextT;\n  if (!tEqual) return false;\n\n  const additionalTextInputPropsEven =\n    prevAdditionalTextInputProps === nextAdditionalTextInputProps;\n  if (!additionalTextInputPropsEven) return false;\n\n  const disabledEqual = prevDisabled === nextDisabled;\n  if (!disabledEqual) return false;\n\n  const editingEqual = !!prevEditing === !!nextEditing;\n  if (!editingEqual) return false;\n\n  const imageUploadsEqual = prevImageUploads.length === nextImageUploads.length;\n  if (!imageUploadsEqual) return false;\n\n  const giphyActiveEqual = prevGiphyActive === nextGiphyActive;\n  if (!giphyActiveEqual) return false;\n\n  const quotedMessageEqual =\n    !!prevQuotedMessage &&\n    !!nextQuotedMessage &&\n    typeof prevQuotedMessage !== 'boolean' &&\n    typeof nextQuotedMessage !== 'boolean'\n      ? prevQuotedMessage.id === nextQuotedMessage.id\n      : !!prevQuotedMessage === !!nextQuotedMessage;\n  if (!quotedMessageEqual) return false;\n\n  const sendingEqual = prevSending.current === nextSending.current;\n  if (!sendingEqual) return false;\n\n  const showMoreOptionsEqual = prevShowMoreOptions === nextShowMoreOptions;\n  if (!showMoreOptionsEqual) return false;\n\n  const isValidMessageEqual = prevIsValidMessage() === nextIsValidMessage();\n  if (!isValidMessageEqual) return false;\n\n  const asyncUploadsEqual = Object.keys(prevAsyncUploads).every(\n    (key) =>\n      prevAsyncUploads[key].state === nextAsyncUploads[key].state &&\n      prevAsyncUploads[key].url === nextAsyncUploads[key].url,\n  );\n  if (!asyncUploadsEqual) return false;\n\n  const fileUploadsEqual = prevFileUploads.length === nextFileUploads.length;\n  if (!fileUploadsEqual) return false;\n\n  const mentionedUsersEqual = prevMentionedUsers.length === nextMentionedUsers.length;\n  if (!mentionedUsersEqual) return false;\n\n  const suggestionsEqual =\n    !!prevSuggestions?.data && !!nextSuggestions?.data\n      ? prevSuggestions.data.length === nextSuggestions.data.length &&\n        prevSuggestions.data.every(({ name }, index) => name === nextSuggestions.data[index].name)\n      : !!prevSuggestions === !!nextSuggestions;\n  if (!suggestionsEqual) return false;\n\n  const threadEqual =\n    prevThread?.id === nextThread?.id &&\n    prevThread?.text === nextThread?.text &&\n    prevThread?.reply_count === nextThread?.reply_count;\n  if (!threadEqual) return false;\n\n  const threadListEqual = prevThreadList === nextThreadList;\n  if (!threadListEqual) return false;\n\n  return true;\n};\n\nconst MemoizedMessageInput = React.memo(\n  MessageInputWithContext,\n  areEqual,\n) as typeof MessageInputWithContext;\n\nexport type MessageInputProps<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Partial<MessageInputPropsWithContext<StreamChatGenerics>>;\n\n/**\n * UI Component for message input\n * It's a consumer of\n * [Channel Context](https://getstream.io/chat/docs/sdk/reactnative/contexts/channel-context/),\n * [Chat Context](https://getstream.io/chat/docs/sdk/reactnative/contexts/chat-context/),\n * [MessageInput Context](https://getstream.io/chat/docs/sdk/reactnative/contexts/message-input-context/),\n * [Suggestions Context](https://getstream.io/chat/docs/sdk/reactnative/contexts/suggestions-context/), and\n * [Translation Context](https://getstream.io/chat/docs/sdk/reactnative/contexts/translation-context/)\n */\nexport const MessageInput = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: MessageInputProps<StreamChatGenerics>,\n) => {\n  const ownCapabilities = useOwnCapabilitiesContext();\n\n  const { disabled = false, members, watchers } = useChannelContext<StreamChatGenerics>();\n\n  const {\n    additionalTextInputProps,\n    asyncIds,\n    asyncUploads,\n    clearEditingState,\n    clearQuotedMessageState,\n    closeAttachmentPicker,\n    cooldownEndsAt,\n    CooldownTimer,\n    editing,\n    FileUploadPreview,\n    fileUploads,\n    giphyActive,\n    ImageUploadPreview,\n    imageUploads,\n    Input,\n    inputBoxRef,\n    InputButtons,\n    InputEditingStateHeader,\n    InputGiphySearch,\n    InputReplyStateHeader,\n    isValidMessage,\n    maxNumberOfFiles,\n    mentionedUsers,\n    numberOfUploads,\n    quotedMessage,\n    removeFile,\n    removeImage,\n    resetInput,\n    SendButton,\n    sending,\n    sendMessageAsync,\n    SendMessageDisallowedIndicator,\n    setGiphyActive,\n    setShowMoreOptions,\n    showMoreOptions,\n    ShowThreadMessageInChannelButton,\n    uploadNewFile,\n    uploadNewImage,\n  } = useMessageInputContext<StreamChatGenerics>();\n\n  const { Reply } = useMessagesContext<StreamChatGenerics>();\n\n  const {\n    AutoCompleteSuggestionHeader,\n    AutoCompleteSuggestionItem,\n    AutoCompleteSuggestionList,\n    suggestions,\n    triggerType,\n  } = useSuggestionsContext<StreamChatGenerics>();\n\n  const { thread } = useThreadContext<StreamChatGenerics>();\n\n  const { t } = useTranslationContext();\n\n  if (!ownCapabilities.sendMessage && SendMessageDisallowedIndicator) {\n    return <SendMessageDisallowedIndicator />;\n  }\n\n  return (\n    <MemoizedMessageInput\n      {...{\n        additionalTextInputProps,\n        asyncIds,\n        asyncUploads,\n        AutoCompleteSuggestionHeader,\n        AutoCompleteSuggestionItem,\n        AutoCompleteSuggestionList,\n        clearEditingState,\n        clearQuotedMessageState,\n        closeAttachmentPicker,\n        cooldownEndsAt,\n        CooldownTimer,\n        disabled,\n        editing,\n        FileUploadPreview,\n        fileUploads,\n        giphyActive,\n        ImageUploadPreview,\n        imageUploads,\n        Input,\n        inputBoxRef,\n        InputButtons,\n        InputEditingStateHeader,\n        InputGiphySearch,\n        InputReplyStateHeader,\n        isValidMessage,\n        maxNumberOfFiles,\n        members,\n        mentionedUsers,\n        numberOfUploads,\n        quotedMessage,\n        removeFile,\n        removeImage,\n        Reply,\n        resetInput,\n        SendButton,\n        sending,\n        sendMessageAsync,\n        setGiphyActive,\n        setShowMoreOptions,\n        showMoreOptions,\n        ShowThreadMessageInChannelButton,\n        suggestions,\n        t,\n        thread,\n        triggerType,\n        uploadNewFile,\n        uploadNewImage,\n        watchers,\n      }}\n      {...props}\n    />\n  );\n};\n\nMessageInput.displayName = 'MessageInput{messageInput}';\n"]}