{"version":3,"sources":["AttachmentPicker.tsx"],"names":["dayjs","extend","duration","styles","StyleSheet","create","container","flexGrow","durationText","fontWeight","overlay","alignItems","flex","videoView","bottom","display","flexDirection","justifyContent","paddingHorizontal","position","width","screenHeight","fullScreenHeight","Dimensions","get","height","AttachmentVideo","props","asset","ImageOverlaySelectedComponent","maxNumberOfFiles","numberOfAttachmentPickerImageColumns","numberOfUploads","selected","setSelectedFiles","theme","attachmentPicker","image","imageOverlay","colors","white","playableDuration","uri","videoDuration","ONE_HOUR_IN_SECONDS","durationLabel","isDurationLongerThanHour","formattedDurationParam","formattedVideoDuration","format","size","onPressVideo","id","localAssetURI","files","filter","file","Alert","alert","name","filename","fileSize","type","margin","backgroundColor","color","AttachmentImage","setSelectedImages","onPressImage","images","renderItem","item","contentType","fileType","startsWith","AttachmentPicker","React","forwardRef","ref","AttachmentPickerBottomSheetHandle","attachmentPickerBottomSheetHandleHeight","attachmentPickerBottomSheetHeight","AttachmentPickerError","attachmentPickerErrorButtonText","AttachmentPickerErrorImage","attachmentPickerErrorText","numberOfAttachmentImagesToLoadPerCall","translucentStatusBar","bottomSheetContentContainer","closePicker","selectedFiles","selectedImages","selectedPicker","setSelectedPicker","topInset","currentIndex","setCurrentIndex","endCursor","setEndCursor","photoError","setPhotoError","hasNextPage","setHasNextPage","loadingPhotos","setLoadingPhotos","photos","setPhotos","bottomSheetCloseOnKeyboardShowTimeout","getMorePhotos","after","first","results","assets","console","log","backAction","undefined","backHandler","BackHandler","addEventListener","remove","hideAttachmentPicker","current","clearTimeout","setTimeout","close","keyboardSubscription","Platform","OS","Keyboard","addListener","removeListener","selectedPhotos","map","length","some","handleHeight","statusBarHeight","StatusBar","currentHeight","bottomBarHeight","androidBottomBarHeightAdjustment","initialSnapPoint","finalSnapPoint","snapPoints","opacity","displayName"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport {\n  Alert,\n  BackHandler,\n  Dimensions,\n  ImageBackground,\n  Keyboard,\n  Platform,\n  StatusBar,\n  StyleSheet,\n  Text,\n  View,\n} from 'react-native';\n\nimport BottomSheet, {\n  BottomSheetFlatList,\n  BottomSheetHandleProps,\n  TouchableOpacity,\n} from '@gorhom/bottom-sheet';\nimport dayjs from 'dayjs';\nimport duration from 'dayjs/plugin/duration';\nimport { lookup } from 'mime-types';\n\nimport type { AttachmentPickerErrorProps } from './components/AttachmentPickerError';\n\nimport { useAttachmentPickerContext } from '../../contexts/attachmentPickerContext/AttachmentPickerContext';\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport { Recorder } from '../../icons';\nimport { getLocalAssetUri, getPhotos } from '../../native';\nimport type { Asset, File } from '../../types/types';\nimport { vh, vw } from '../../utils/utils';\n\ndayjs.extend(duration);\n\nconst styles = StyleSheet.create({\n  container: {\n    flexGrow: 1,\n  },\n  durationText: {\n    fontWeight: 'bold',\n  },\n  overlay: {\n    alignItems: 'flex-end',\n    flex: 1,\n  },\n  videoView: {\n    bottom: 5,\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingHorizontal: 5,\n    position: 'absolute',\n    width: '100%',\n  },\n});\n\nconst screenHeight = vh(100);\nconst fullScreenHeight = Dimensions.get('window').height;\n\nexport type AttachmentPickerItemType = {\n  asset: Asset;\n  ImageOverlaySelectedComponent: React.ComponentType;\n  maxNumberOfFiles: number;\n  numberOfUploads: number;\n  selected: boolean;\n  setSelectedFiles: React.Dispatch<React.SetStateAction<File[]>>;\n  setSelectedImages: React.Dispatch<React.SetStateAction<Asset[]>>;\n  numberOfAttachmentPickerImageColumns?: number;\n};\n\ntype AttachmentImageProps = Omit<AttachmentPickerItemType, 'setSelectedFiles'>;\n\ntype AttachmentVideoProps = Omit<AttachmentPickerItemType, 'setSelectedImages'>;\n\nconst AttachmentVideo: React.FC<AttachmentVideoProps> = (props) => {\n  const {\n    asset,\n    ImageOverlaySelectedComponent,\n    maxNumberOfFiles,\n    numberOfAttachmentPickerImageColumns,\n    numberOfUploads,\n    selected,\n    setSelectedFiles,\n  } = props;\n\n  const {\n    theme: {\n      attachmentPicker: { durationText, image, imageOverlay },\n      colors: { overlay, white },\n    },\n  } = useTheme();\n\n  const { duration, playableDuration, uri } = asset;\n\n  const videoDuration = duration ? duration : playableDuration;\n\n  const ONE_HOUR_IN_SECONDS = 3600;\n\n  let durationLabel = '00:00';\n\n  if (videoDuration) {\n    const isDurationLongerThanHour = videoDuration / ONE_HOUR_IN_SECONDS >= 1;\n    const formattedDurationParam = isDurationLongerThanHour ? 'HH:mm:ss' : 'mm:ss';\n    const formattedVideoDuration = dayjs\n      .duration(videoDuration, 'second')\n      .format(formattedDurationParam);\n    durationLabel = formattedVideoDuration;\n  }\n\n  const size = vw(100) / (numberOfAttachmentPickerImageColumns || 3) - 2;\n\n  const onPressVideo = async () => {\n    // For the case of expo messaging app where you need to fetch the asset uri from asset id\n    const localAssetURI = asset.id && (await getLocalAssetUri(asset.id));\n    if (selected) {\n      setSelectedFiles((files) => files.filter((file) => file.uri !== asset.uri));\n    } else {\n      setSelectedFiles((files) => {\n        if (numberOfUploads >= maxNumberOfFiles) {\n          Alert.alert('Maximum number of files reached');\n          return files;\n        }\n        return [\n          ...files,\n          {\n            duration: durationLabel,\n            name: asset.filename,\n            size: asset.fileSize,\n            type: 'video',\n            uri: localAssetURI || asset.uri,\n          },\n        ];\n      });\n    }\n  };\n\n  return (\n    <TouchableOpacity onPress={onPressVideo}>\n      <ImageBackground\n        source={{ uri }}\n        style={[\n          {\n            height: size,\n            margin: 1,\n            width: size,\n          },\n          image,\n        ]}\n      >\n        {selected && (\n          <View style={[styles.overlay, { backgroundColor: overlay }, imageOverlay]}>\n            <ImageOverlaySelectedComponent />\n          </View>\n        )}\n        <View style={styles.videoView}>\n          <Recorder height={20} pathFill={white} width={25} />\n          {videoDuration ? (\n            <Text style={[styles.durationText, durationText, { color: white }]}>\n              {durationLabel}\n            </Text>\n          ) : null}\n        </View>\n      </ImageBackground>\n    </TouchableOpacity>\n  );\n};\n\nconst AttachmentImage: React.FC<AttachmentImageProps> = (props) => {\n  const {\n    asset,\n    ImageOverlaySelectedComponent,\n    maxNumberOfFiles,\n    numberOfAttachmentPickerImageColumns,\n    numberOfUploads,\n    selected,\n    setSelectedImages,\n  } = props;\n  const {\n    theme: {\n      attachmentPicker: { image, imageOverlay },\n      colors: { overlay },\n    },\n  } = useTheme();\n\n  const size = vw(100) / (numberOfAttachmentPickerImageColumns || 3) - 2;\n\n  const { uri } = asset;\n\n  const onPressImage = () => {\n    if (selected) {\n      setSelectedImages((images) => images.filter((image) => image.uri !== asset.uri));\n    } else {\n      setSelectedImages((images) => {\n        if (numberOfUploads >= maxNumberOfFiles) {\n          Alert.alert('Maximum number of files reached');\n          return images;\n        }\n        return [...images, asset];\n      });\n    }\n  };\n\n  return (\n    <TouchableOpacity onPress={onPressImage}>\n      <ImageBackground\n        source={{ uri }}\n        style={[\n          {\n            height: size,\n            margin: 1,\n            width: size,\n          },\n          image,\n        ]}\n      >\n        {selected && (\n          <View style={[styles.overlay, { backgroundColor: overlay }, imageOverlay]}>\n            <ImageOverlaySelectedComponent />\n          </View>\n        )}\n      </ImageBackground>\n    </TouchableOpacity>\n  );\n};\n\nconst renderItem = ({ item }: { item: AttachmentPickerItemType }) => {\n  const {\n    asset,\n    ImageOverlaySelectedComponent,\n    maxNumberOfFiles,\n    numberOfAttachmentPickerImageColumns,\n    numberOfUploads,\n    selected,\n    setSelectedFiles,\n    setSelectedImages,\n  } = item;\n\n  const contentType = lookup(asset.filename) || 'multipart/form-data';\n\n  const fileType = asset.filename\n    ? contentType.startsWith('image/')\n      ? 'image'\n      : 'video'\n    : asset.type === 'video'\n    ? 'video'\n    : 'image';\n\n  return fileType === 'image' ? (\n    <AttachmentImage\n      asset={asset}\n      ImageOverlaySelectedComponent={ImageOverlaySelectedComponent}\n      maxNumberOfFiles={maxNumberOfFiles}\n      numberOfAttachmentPickerImageColumns={numberOfAttachmentPickerImageColumns}\n      numberOfUploads={numberOfUploads}\n      selected={selected}\n      setSelectedImages={setSelectedImages}\n    />\n  ) : (\n    <AttachmentVideo\n      asset={asset}\n      ImageOverlaySelectedComponent={ImageOverlaySelectedComponent}\n      maxNumberOfFiles={maxNumberOfFiles}\n      numberOfAttachmentPickerImageColumns={numberOfAttachmentPickerImageColumns}\n      numberOfUploads={numberOfUploads}\n      selected={selected}\n      setSelectedFiles={setSelectedFiles}\n    />\n  );\n};\n\nexport type AttachmentPickerProps = {\n  /**\n   * Custom UI component to render [draggable handle](https://github.com/GetStream/stream-chat-react-native/blob/main/screenshots/docs/1.png) of attachment picker.\n   *\n   * **Default** [AttachmentPickerBottomSheetHandle](https://github.com/GetStream/stream-chat-react-native/blob/main/package/src/components/AttachmentPicker/components/AttachmentPickerBottomSheetHandle.tsx)\n   */\n  AttachmentPickerBottomSheetHandle: React.FC<BottomSheetHandleProps>;\n  /**\n   * Custom UI component to render error component while opening attachment picker.\n   *\n   * **Default** [AttachmentPickerError](https://github.com/GetStream/stream-chat-react-native/blob/main/package/src/components/AttachmentPicker/components/AttachmentPickerError.tsx)\n   */\n  AttachmentPickerError: React.ComponentType<AttachmentPickerErrorProps>;\n  /**\n   * Custom UI component to render error image for attachment picker\n   *\n   * **Default** [AttachmentPickerErrorImage](https://github.com/GetStream/stream-chat-react-native/blob/main/package/src/components/AttachmentPicker/components/AttachmentPickerErrorImage.tsx)\n   */\n  AttachmentPickerErrorImage: React.ComponentType;\n  /**\n   * Custom UI component to render overlay component, that shows up on top of [selected image](https://github.com/GetStream/stream-chat-react-native/blob/main/screenshots/docs/1.png) (with tick mark)\n   *\n   * **Default** [ImageOverlaySelectedComponent](https://github.com/GetStream/stream-chat-react-native/blob/main/package/src/components/AttachmentPicker/components/ImageOverlaySelectedComponent.tsx)\n   */\n  ImageOverlaySelectedComponent: React.ComponentType;\n  attachmentPickerBottomSheetHandleHeight?: number;\n  attachmentPickerBottomSheetHeight?: number;\n  attachmentPickerErrorButtonText?: string;\n  attachmentPickerErrorText?: string;\n  numberOfAttachmentImagesToLoadPerCall?: number;\n  numberOfAttachmentPickerImageColumns?: number;\n  translucentStatusBar?: boolean;\n};\n\nexport const AttachmentPicker = React.forwardRef(\n  (props: AttachmentPickerProps, ref: React.ForwardedRef<BottomSheet>) => {\n    const {\n      AttachmentPickerBottomSheetHandle,\n      attachmentPickerBottomSheetHandleHeight,\n      attachmentPickerBottomSheetHeight,\n      AttachmentPickerError,\n      attachmentPickerErrorButtonText,\n      AttachmentPickerErrorImage,\n      attachmentPickerErrorText,\n      ImageOverlaySelectedComponent,\n      numberOfAttachmentImagesToLoadPerCall,\n      numberOfAttachmentPickerImageColumns,\n      translucentStatusBar,\n    } = props;\n\n    const {\n      theme: {\n        attachmentPicker: { bottomSheetContentContainer },\n        colors: { white },\n      },\n    } = useTheme();\n    const {\n      closePicker,\n      maxNumberOfFiles,\n      selectedFiles,\n      selectedImages,\n      selectedPicker,\n      setSelectedFiles,\n      setSelectedImages,\n      setSelectedPicker,\n      topInset,\n    } = useAttachmentPickerContext();\n\n    const [currentIndex, setCurrentIndex] = useState(-1);\n    const [endCursor, setEndCursor] = useState<string>();\n    const [photoError, setPhotoError] = useState(false);\n    const [hasNextPage, setHasNextPage] = useState(true);\n    const [loadingPhotos, setLoadingPhotos] = useState(false);\n    const [photos, setPhotos] = useState<Asset[]>([]);\n    const bottomSheetCloseOnKeyboardShowTimeout = useRef<NodeJS.Timeout>();\n\n    const getMorePhotos = async () => {\n      if (hasNextPage && !loadingPhotos && currentIndex > -1 && selectedPicker === 'images') {\n        setLoadingPhotos(true);\n        try {\n          const results = await getPhotos({\n            after: endCursor,\n            first: numberOfAttachmentImagesToLoadPerCall ?? 60,\n          });\n          if (endCursor) {\n            setPhotos([...photos, ...results.assets]);\n          } else {\n            setPhotos(results.assets);\n          }\n          setEndCursor(results.endCursor);\n          setHasNextPage(results.hasNextPage || false);\n        } catch (error) {\n          console.log(error);\n          setPhotoError(true);\n        }\n        setLoadingPhotos(false);\n      }\n    };\n\n    useEffect(() => {\n      const backAction = () => {\n        if (selectedPicker) {\n          setSelectedPicker(undefined);\n          closePicker();\n          return true;\n        }\n\n        return false;\n      };\n\n      const backHandler = BackHandler.addEventListener('hardwareBackPress', backAction);\n\n      return () => backHandler.remove();\n    }, [selectedPicker]);\n\n    useEffect(() => {\n      const hideAttachmentPicker = () => {\n        if (bottomSheetCloseOnKeyboardShowTimeout.current) {\n          clearTimeout(bottomSheetCloseOnKeyboardShowTimeout.current);\n        }\n        setSelectedPicker(undefined);\n        // This short timeout is to prevent a race condition\n        // where the close function is called during the point when a internal container layout happens within the bottomsheet due to keyboard affecting the layout\n        // If the container layout measures a shorter height than previous but if the close snapped to the previous height's position, the bottom sheet will show up\n        // this short delay ensures that close function is always called after a container layout due to keyboard change\n        bottomSheetCloseOnKeyboardShowTimeout.current = setTimeout(\n          () => (ref as React.MutableRefObject<BottomSheet | undefined>).current?.close(),\n          150,\n        );\n      };\n      const keyboardSubscription =\n        Platform.OS === 'ios'\n          ? Keyboard.addListener('keyboardWillShow', hideAttachmentPicker)\n          : Keyboard.addListener('keyboardDidShow', hideAttachmentPicker);\n\n      return () => {\n        if (keyboardSubscription?.remove) {\n          keyboardSubscription.remove();\n          return;\n        }\n\n        // To keep compatibility with older versions of React Native, where `remove()` is not available\n        if (Platform.OS === 'ios') {\n          Keyboard.removeListener('keyboardWillShow', hideAttachmentPicker);\n        } else {\n          Keyboard.removeListener('keyboardDidShow', hideAttachmentPicker);\n        }\n        if (bottomSheetCloseOnKeyboardShowTimeout.current) {\n          clearTimeout(bottomSheetCloseOnKeyboardShowTimeout.current);\n        }\n      };\n    }, []);\n\n    useEffect(() => {\n      if (currentIndex < 0) {\n        setSelectedPicker(undefined);\n        if (!loadingPhotos) {\n          setEndCursor(undefined);\n          setHasNextPage(true);\n        }\n      }\n    }, [currentIndex]);\n\n    useEffect(() => {\n      if (\n        selectedPicker === 'images' &&\n        endCursor === undefined &&\n        currentIndex > -1 &&\n        !loadingPhotos\n      ) {\n        setPhotoError(false);\n        getMorePhotos();\n      }\n    }, [currentIndex, selectedPicker]);\n\n    const selectedPhotos = photos.map((asset) => ({\n      asset,\n      ImageOverlaySelectedComponent,\n      maxNumberOfFiles,\n      numberOfAttachmentPickerImageColumns,\n      numberOfUploads: selectedFiles.length + selectedImages.length,\n      selected:\n        selectedImages.some((image) => image.uri === asset.uri) ||\n        selectedFiles.some((file) => file.uri === asset.uri),\n      setSelectedFiles,\n      setSelectedImages,\n    }));\n\n    const handleHeight = attachmentPickerBottomSheetHandleHeight || 20;\n\n    /**\n     * This is to handle issues with Android measurements coming back incorrect.\n     * If the StatusBar height is perfectly 1/2 of the difference between the two\n     * dimensions for screen and window, it is incorrect and we need to account for\n     * this. If you use a translucent header bar more adjustments are needed.\n     */\n    const statusBarHeight = StatusBar.currentHeight ?? 0;\n    const bottomBarHeight = fullScreenHeight - screenHeight - statusBarHeight;\n    const androidBottomBarHeightAdjustment =\n      Platform.OS === 'android'\n        ? bottomBarHeight === statusBarHeight\n          ? translucentStatusBar\n            ? 0\n            : StatusBar.currentHeight ?? 0\n          : translucentStatusBar\n          ? bottomBarHeight > statusBarHeight\n            ? -bottomBarHeight + statusBarHeight\n            : bottomBarHeight > 0\n            ? -statusBarHeight\n            : 0\n          : bottomBarHeight > 0\n          ? 0\n          : statusBarHeight\n        : 0;\n\n    const initialSnapPoint =\n      attachmentPickerBottomSheetHeight ?? Platform.OS === 'android'\n        ? 308 + (fullScreenHeight - screenHeight + androidBottomBarHeightAdjustment) - handleHeight\n        : 308 + (fullScreenHeight - screenHeight + androidBottomBarHeightAdjustment);\n\n    const finalSnapPoint =\n      Platform.OS === 'android'\n        ? fullScreenHeight - topInset - handleHeight\n        : fullScreenHeight - topInset;\n\n    /**\n     * Snap points changing cause a rerender of the position,\n     * this is an issue if you are calling close on the bottom sheet.\n     */\n    const snapPoints = useMemo(\n      () => [initialSnapPoint, finalSnapPoint],\n      [initialSnapPoint, finalSnapPoint],\n    );\n\n    return (\n      <>\n        <BottomSheet\n          containerHeight={fullScreenHeight}\n          enablePanDownToClose={true}\n          handleComponent={\n            /**\n             * using `null` here instead of `style={{ opacity: photoError ? 0 : 1 }}`\n             * as opacity is not an allowed style\n             */\n            photoError ? null : AttachmentPickerBottomSheetHandle\n          }\n          handleHeight={handleHeight}\n          index={-1}\n          onChange={setCurrentIndex}\n          ref={ref}\n          snapPoints={snapPoints}\n        >\n          <BottomSheetFlatList\n            contentContainerStyle={[\n              styles.container,\n              { backgroundColor: white },\n              bottomSheetContentContainer,\n              { opacity: photoError ? 0 : 1 },\n            ]}\n            data={selectedPhotos}\n            keyExtractor={(item) => item.asset.uri}\n            numColumns={numberOfAttachmentPickerImageColumns ?? 3}\n            onEndReached={getMorePhotos}\n            renderItem={renderItem}\n          />\n        </BottomSheet>\n        {selectedPicker === 'images' && photoError && (\n          <AttachmentPickerError\n            attachmentPickerBottomSheetHeight={attachmentPickerBottomSheetHeight}\n            attachmentPickerErrorButtonText={attachmentPickerErrorButtonText}\n            AttachmentPickerErrorImage={AttachmentPickerErrorImage}\n            attachmentPickerErrorText={attachmentPickerErrorText}\n          />\n        )}\n      </>\n    );\n  },\n);\n\nAttachmentPicker.displayName = 'AttachmentPicker';\n"]}